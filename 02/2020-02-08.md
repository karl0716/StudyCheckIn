#TCP、IP 详解
## 概述
- 分层: 经典的四层
    - 链路层: 处理与电缆（或其他任何传输媒介的**物理**接口细节）例如设备驱动等
    - 网络层:处理分组在网络中的活动。例如分组选路，IP
    - 运输层:为两台主机上的应用程序提供端到端的通讯。TCP/UDP
    - 应用层:处理特定的应用程序细节。
    
### 四层网络模型具体实例
- 大多数的网络应用程序都被设计成客户端-服务器模式。
- 双方都有对应的一个/多个协议进行通讯
- 应用程序通过是用户进程，而下三层一般在内核中执行。
- 应用层关心应用程序的细节，下三层处理通讯的细节。

![TCP_IP图解-四层实例.jpg](https://i.loli.net/2020/02/07/uEhoBTzQSIdWXPM.jpg)

- 分层的意义：
    - 为上层应用程序屏蔽了底层的具体繁琐的实现细节。

## TCP/IP的工作原理
- 看一下通过路由器连接两个网络。

![TCP_IP图解-通过路由器连接两个网络4.jpg](https://i.loli.net/2020/02/08/pSYL9f82THdsuUi.jpg)

由上图可知一个网络大概包含如下内容：

- 端系统：客户端和服务端（pc+端口号 （大厦 + 房间号）标识一个应用程序）
- 中间系统：就是路由器，有一个路由协议iS-iS，中间系统到中间系统
- 应用层和传输层使用端到端（end-to-end）协议：图中的TCP - TCP
- 网络层提供的是逐跳协议：IP协议是pc到路由器 -> 路由器到pc
- 链路层：逐介质到逐介质的，图中的以太网和令牌环都是介质。
- 网络Ip提供的是一种不可靠的服务，他只是尽可能快的把分组从源节点送到目的节点，但不提供肯可靠性保障。
- TCP在不可靠的Ip层上提供了一种可靠的运输层，
- 互联网的目的之一就是在应用程序中隐藏所有的物理细节。

通过下图我们理解一下可靠TCP和不可靠的IP：
![TCP_IP图解-淘宝买东西的案例.jpg](https://i.loli.net/2020/02/08/x2eLhTYA8CWoJEy.jpg)
- TCP只的买家和卖家之间的关系：有确认收货的过程。
- IP是指包裹传送的过程：包裹又丢失的可能。
- 在买家在一定的时间还没收到包裹，就会联系卖家，卖家发现包裹丢失，就会重新发一个包裹给买家，TCP的超时重传。
- 当买家收到东西之后，确认收货了之后，本次交易完成。
    
