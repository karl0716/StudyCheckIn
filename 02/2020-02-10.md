# 学习内容 
- 操作系统相关的概念

# 用户空间与内核空间
- 现在操作系统都是采用虚拟存储器，那么对32位操作系统而言，它的寻址空间（虚拟存储空间）为4G（2的32次方）。操作系统的核心是内核，独立于普通的应用程序，可以访问受保护的内存空间，也有访问底层硬件设备的所有权限。为了保证用户进程不能直接操作内核（kernel），保证内核的安全，操作系统将虚拟空间划分为两部分，一部分为内核空间，一部分为用户空间。针对linux操作系统而言，将最高的1G字节（从虚拟地址0xC0000000到0xFFFFFFFF），供内核使用，称为内核空间，而将较低的3G字节（从虚拟地址0x00000000到0xBFFFFFFF），供各个进程使用，称为用户空间。

- **用户态**:是指我们应用程序在执行的过程中，cpu所处于的特权级的状态,优先级比较低不能直接访问特权的机器指令和IO
-  **内核态**:是指操作系统运行的过程中cpu所处于的一个状态，在这个状态下操作系统可以执行任何一个指令。完全的控制整个计算机系统。操作系统的核心是内核，独立于普通的应用程序，可以访问受保护的内存空间，也有访问底层硬件设备的所有权限。
- 应用程序调用一个系统调用的时候，会从用户态到内核态的转换，从而使的控制权从应用程序到操作系统。
- 应用程序系统调用和函数调用的区别：
- 函数调用：应用程序进行函数调用的时候是在一个栈空间中完成了对函数的调用
- 系统调用：应用程序进行系统调用的时候需要从用户态切换到内核态，用户态和内核态都有各自的堆栈，是需要切换堆栈，同时也要进行特权级的转换，特权级的转换和堆栈的切换都是需要一定的cpu开销。
-  各自的优缺点：
- 函数调用：开销比较小，安全系数比较低
- 系统调用：开销比较大，安全系统比较高

# 操作系统- 进程
## 进程切换
- 为了控制进程的执行，内核必须有能力挂起正在CPU上运行的进程，并恢复以前挂起的某个进程的执行。这种行为被称为进程切换。因此可以说，任何进程都是在操作系统内核的支持下运行的，是与内核紧密相关的。
- 从一个进程的运行转到另一个进程上运行，这个过程中经过下面这些变化：
    1. 保存处理机上下文，包括程序计数器和其他寄存器。
    2. 更新PCB信息。
    3. 把进程的PCB移入相应的队列，如就绪、在某事件阻塞等队列。
    4. 选择另一个进程执行，并更新其PCB。
    5. 更新内存管理的数据结构。
    6. 恢复处理机上下文。


## 进程的阻塞
- 正在执行的进程，由于期待的某些事件未发生，如请求系统资源失败、等待某种操作的完成、新数据尚未到达或无新工作做等，则由系统自动执行阻塞原语(Block)，使自己由运行状态变为阻塞状态。可见，进程的阻塞是进程自身的一种主动行为，也因此只有处于运行态的进程（获得CPU），才可能将其转为阻塞状态。**当进程进入阻塞状态，是不占用CPU资源的**。


# CPU工作方式、多核心、超线程技术
- 要想理解超线程的技术我们首先要理解cpu的架构和逻辑

## cpu的结构
- 一个cpu会含有两个非常重要的模块
    1. 运算处理单元，简称: PU
    2. 架构状态单元，简称: AS

- PU: 一般就是执行运算，比如算数运算等。
- AS: 执行一些逻辑和调度方面的操作，控制内存访问等。

## 超线程技术（Hyper-Threading  HT）
- 超线程不是我们经常说的多线程，超线程是一种可以将CPU内部暂时闲置处理资源充分“调动”起来的技术。

### 工作原理
- 对于单一处理器核心来说来说，虽然也可以每秒钟处理成千上万条指令，但是在某一时刻，只能够对一条指令(单个线程)进行处理，超线程技术能够把一个物理处理器在软件层变成两个逻辑处理器，可以使处理器在某一时刻，同步并行处理更多指令和数据(多个线程)，当然了实际效能不可实现双倍提升，毕竟干活的核心只有一个。
